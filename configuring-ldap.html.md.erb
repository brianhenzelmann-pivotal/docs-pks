---
title: Configuring LDAP as an Identity Provider for UAA
owner: PKS
---

To integrate UAA with one or more LDAP servers, configure <%= vars.product_short %> with your LDAP endpoint information as follows:

1. Under **UAA**, select **LDAP Server**.<br>
  <img src="images/ldap1.png" alt="LDAP Server configuration pane" width="538">

1. For **Server URL**, enter the URLs that point to your LDAP server.
If you have multiple LDAP servers, separate their URLs with spaces.
Each URL must include one of the following protocols:
    * `ldap://`: Use this protocol if your LDAP server uses an unencrypted connection.
    * `ldaps://`: Use this protocol if your LDAP server uses SSL for an encrypted connection.
To support an encrypted connection, the LDAP server must hold a trusted certificate or you must import a trusted certificate to the JVM truststore.

1. For **LDAP Credentials**, enter the LDAP Distinguished Name (DN) and password for binding to the LDAP server.
For example, `cn=administrator,ou=Users,dc=example,dc=com`.
If the bind user belongs to a different search base, you must use the full DN.
    <p class="note"><strong>Note</strong>: We recommend that you provide LDAP credentials that grant read-only permissions on the LDAP search base and the LDAP group search base.</p>

1. For **User Search Base**, enter the location in the LDAP directory tree where LDAP user search begins. The LDAP search base typically matches your domain name.
<br><br>
For example, a domain named `cloud.example.com` may use `ou=Users,dc=example,dc=com` as its LDAP user search base.

1. For **User Search Filter**, enter a string to use for LDAP user search criteria.
The search criteria allows LDAP to perform more effective and efficient searches.
For example, the standard LDAP search filter `cn=Smith` returns all objects with a common name equal to `Smith`.
<br><br>
In the LDAP search filter string that you use to configure <%= vars.product_short %>, use `{0}` instead of the username.
For example, use `cn={0}` to return all LDAP objects with the same common name as the username.
<br><br>
In addition to `cn`, other common attributes are `mail`, `uid` and, in the case of Active Directory, `sAMAccountName`.
    <p class="note"><strong>Note</strong>: For information about testing and troubleshooting your LDAP search filters, see <a href="https://community.pivotal.io/s/article/Configuring-LDAP-Integration-with-Pivotal-Cloud-Foundry">Configuring LDAP Integration with Pivotal Cloud Foundry</a>.</p>

1. For **Group Search Base**, enter the location in the LDAP directory tree where the LDAP group search begins.
<br><br>
For example, a domain named `cloud.example.com` may use `ou=Groups,dc=example,dc=com` as its LDAP group search base.
<br><br>
Follow the instructions in the [Grant <%= vars.product_short %> Access to an External LDAP Group](manage-users.html#external-group) section of _Managing Users in <%= vars.product_short %> with UAA_ to map the groups under this search base to roles in <%= vars.product_short %>.
    <p class="note"><strong>Note</strong>: You must configure **Group Search Base** if you are mapping an external LDAP group to a kubernetes group or an admin role.</p>

1. For **Group Search Filter**, enter a string that defines LDAP group search criteria. The standard value is `member={0}`.

1. For **Server SSL Cert**, paste in the root certificate from your CA certificate or your self-signed certificate.
    <img src="images/ldap-cert.png" alt="Server SSL Cert field">

1. For **First Name Attribute**, enter the attribute name in your LDAP directory that contains user first names.
For example, `cn`.
    <img src="images/ldap2.png" alt="LDAP configuration fields">

1. For **Last Name Attribute**, enter the attribute name in your LDAP directory that contains user last names.
For example, `sn`.

1. For **Email Attribute**, enter the attribute name in your LDAP directory that contains user email addresses.
For example, `mail`.

1. For **Email Domain(s)**, enter a comma-separated list of the email domains for external users who can receive invitations to Apps Manager.

1. For **LDAP Referrals**, choose how UAA handles LDAP server referrals to other user stores.
UAA can follow the external referrals, ignore them without returning errors, or generate an error for each external referral and abort the authentication.

1. For **External Groups Whitelist**, enter a comma-separated list of group patterns which need to be populated in the user's `id_token`. For further information on accepted patterns see the description of the `config.externalGroupsWhitelist` in the OAuth/OIDC [Identity Provider Documentation](https://docs.cloudfoundry.org/api/uaa/version/4.19.0/index.html#oauth-oidc).
<p class="note"><strong>Note</strong>: When sent as a Bearer token in the Authentication header, wide pattern queries for users who are members of multiple groups, can cause the size of the <code>id_token</code> to extend beyond what is supported by web servers.</p>
  ![External Groups Whitelist field](images/external-groups-whitelist.png)

1. Click **Save**.